# 并行体系结构性能优化实验

本项目包含针对现代处理器体系结构中两个关键性能因素的实验：缓存局部性和指令级并行性。通过具体的代码实现和性能分析，验证这些因素对程序执行效率的影响。

## 实验内容

### 1. 缓存局部性实验

比较矩阵计算中按行访问和按列访问的性能差异：

- **按列访问方式**：对n*n矩阵B的每一列与向量A计算内积 `sum[i] += A[j] * B[j][i]`
- **按行访问方式**：重构算法，通过按行遍历矩阵实现相同功能 `sum[j] += A[i] * B[i][j]`

实验证明了在C/C++中，按行访问二维数组可以显著提高缓存命中率，在大规模数据上获得3-10倍的性能提升。

### 2. 指令级并行性实验

比较普通顺序累加和四路并行累加的性能差异：

- **普通累加**：单一变量依次累加0到n-1的值
- **四路累加**：使用4个独立变量分别累加不同序列，减少指令间依赖

实验证明减少指令依赖链可以提高处理器指令级并行度，获得1.4-3倍的性能提升。

### 3. 性能分析工具

项目中的`vtune1.cpp`是用于Intel VTune Profiler分析的测试程序，提供四种测试模式：

- 模式1：矩阵按列访问测试
- 模式2：矩阵按行访问测试
- 模式3：普通顺序累加测试
- 模式4：四路并行累加测试

使用方法：
```bash
g++ -O2 -o vtune1 vtune1.cpp
./vtune1 [测试模式1-4]
```

## 技术要点

- **缓存局部性优化**：充分利用CPU缓存空间局部性和时间局部性
- **指令级并行优化**：减少指令依赖链，提高超标量处理器执行效率
- **底层性能分析**：使用Intel VTune收集微架构级性能指标，包括缓存命中率、CPU利用率等

## 实验结果

详细实验结果和分析见完整报告。主要发现：

1. 缓存局部性对数据密集型应用的性能影响显著，L1缓存命中率提高可带来3-10倍性能提升
2. 指令级并行通过减少依赖可提高处理器资源利用率，但实际加速比通常低于理论上限
3. 内存访问模式的优化通常比纯计算指令优化带来更显著的性能提升

## 环境要求

- C++编译器（支持C++11或更高）
- Intel VTune Profiler (可选，用于微架构性能分析)
- Python 3.x及matplotlib (用于数据可视化)
